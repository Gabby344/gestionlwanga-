<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dashboard Secr√©taire ¬∑ Institut Saint Charles Lwanga</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
<style>
:root {
  --bleu-fonce: #1e40af;
  --gris-fonce: #1f2937;
  --vert: #10b981;
  --jaune: #f59e0b;
  --rouge: #ef4444;
  --fond-principal: #f4f6f8;
  --ombre-forte: rgba(0,0,0,0.15);
  --ombre-legere: rgba(0,0,0,0.05);
}

body {
  font-family: 'Inter', sans-serif;
  background-color: var(--fond-principal);
  margin: 0;
  padding: 2rem 1rem;
  color: var(--gris-fonce);
  text-align: center;
}

.header {
  max-width: 900px;
  margin: auto;
  margin-bottom: 2rem;
}

h1 { font-size: 2rem; color: var(--bleu-fonce); margin-bottom: 0.25rem; }
h2 { font-size: 1.1rem; font-weight: 400; color: #6b7280; margin-bottom: 2rem; }

.modules-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
  gap: 1.5rem;
  max-width: 900px;
  margin: auto;
}

.module-card {
  display: block;
  background-color: white;
  padding: 1.5rem;
  border-radius: 12px;
  text-decoration: none;
  color: var(--gris-fonce);
  box-shadow: 0 4px 10px var(--ombre-legere);
  transition: transform 0.2s, box-shadow 0.2s;
  border-left: 5px solid var(--vert);
  text-align: left;
}
.module-card:hover {
  transform: translateY(-5px);
  box-shadow: 0 8px 20px var(--ombre-forte);
}
.card-icon { font-size: 2.5rem; color: var(--vert); margin-bottom: 0.5rem; line-height: 1; }
.card-title { font-size: 1.25rem; font-weight: 700; margin-bottom: 0.5rem; color: var(--gris-fonce); }
.card-description { font-size: 0.9rem; color: #6b7280; }

.btn-retour {
  display: inline-block;
  padding: 0.75rem 1.5rem;
  background-color: #e5e7eb;
  color: var(--gris-fonce);
  border-radius: 8px;
  text-decoration: none;
  font-weight: 600;
  margin-top: 3rem;
  transition: background-color 0.2s;
}
.btn-retour:hover { background-color: #d1d5db; }

#userInfo {
  max-width: 900px;
  margin: auto;
  margin-bottom: 1rem;
  font-weight: 500;
  color: #374151;
}
</style>
</head>
<body>

<div class="header">
  <h1>üñäÔ∏è Dashboard Secr√©taire</h1>
  <h2>Institut Saint Charles Lwanga - Gestion des Inscriptions et √âl√®ves</h2>
</div>

<div id="userInfo"></div>

<div class="modules-grid">
  <a href="inscriptions-eleves.html" class="module-card">
      <div class="card-icon">üìã</div>
      <div class="card-title">Inscriptions des √âl√®ves</div>
      <div class="card-description">Enregistrer, filtrer et suivre toutes les inscriptions des √©l√®ves par classe.</div>
  </a>
  
  <a href="liste-eleves.html" class="module-card">
      <div class="card-icon">üìö</div>
      <div class="card-title">Consulter la Liste des √âl√®ves</div>
      <div class="card-description">Afficher tous les √©l√®ves avec possibilit√© de filtrage par classe et recherche rapide.</div>
  </a>
</div>

<a href="dashboard.html" class="btn-retour">‚Üê Retour au Tableau de Bord Principal</a>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

const firebaseConfig = {
  apiKey:"AIzaSyAgv4TDYnR60TXnns-LISqbZTgcdLT31cc",
  authDomain:"gestionlwanga.firebaseapp.com",
  projectId:"gestionlwanga",
  storageBucket:"gestionlwanga.firebasestorage.app",
  messagingSenderId:"622604298611",
  appId:"1:622604298611:web:4ab4314ed3eec6826c3d06"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

const userInfo = document.getElementById("userInfo");

onAuthStateChanged(auth, async user => {
    if(!user){ window.location.href="login.html"; return; }

    try {
        const snap = await getDoc(doc(db, "users", user.uid));
        if(!snap.exists()) throw new Error("Profil introuvable");
        const data = snap.data();
        const role = (data.role || "").toLowerCase();
        if(role !== "secretaire"){
            await signOut(auth);
            window.location.href="login.html";
        }
        const nomComplet = [data.nom, data.postNom, data.prenom].filter(Boolean).join(" ");
        userInfo.textContent = `Connect√© : ${nomComplet} (${role.toUpperCase()})`;
    } catch(err) {
        console.error(err);
        await signOut(auth);
        window.location.href="login.html";
    }
});
</script>

</body>
</html>
